<div class="page-header">
    <h1 class="page-title">ุงูุฒูุฏู ุฏุณุชูโุจูุฏ ุฌุฏุฏ</h1>
    <p>ุชุนุฑู ุฏุณุชูโุจูุฏ ุฌุฏุฏ ุง ุฒุฑูุฌููุนู</p>
</div>

<div class="card">
    <div class="card-header">
        ุงุทูุงุนุงุช ุฏุณุชูโุจูุฏ
    </div>
    <div class="card-body">
        <form action="/inventory/categories/create" method="POST">
            <div class="row">
                <!-- Category Type Selection -->
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="form-label">ููุน ุฏุณุชูโุจูุฏ *</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="category_type" 
                                   id="main_category" value="main" 
                                   <%= (!parentCategories || !req.query.parent) ? 'checked' : '' %>
                                   onchange="toggleParentSelection()">
                            <label class="form-check-label" for="main_category">
                                ๐ ุฏุณุชูโุจูุฏ ุงุตู (ุณุทุญ ุงูู)
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="category_type" 
                                   id="sub_category" value="sub"
                                   <%= (req.query.parent) ? 'checked' : '' %>
                                   onchange="toggleParentSelection()">
                            <label class="form-check-label" for="sub_category">
                                ๐ ุฒุฑูุฌููุนู (ุณุทุญ ุฏูู)
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Parent Category (for subcategories) -->
                <div class="col-md-12" id="parent_selection" 
                     style="display: <%= (req.query.parent) ? 'block' : 'none' %>;">
                    <div class="form-group">
                        <label for="parent_id" class="form-label">ุฏุณุชูโุจูุฏ ูุงูุฏ *</label>
                        <select name="parent_id" id="parent_id" class="form-control">
                            <option value="">ุงูุชุฎุงุจ ุฏุณุชูโุจูุฏ ุงุตู...</option>
                            <% parentCategories.forEach(parent => { %>
                                <option value="<%= parent.id %>" 
                                        <%= (req.query.parent == parent.id) ? 'selected' : '' %>>
                                    <%= parent.name_persian %> (<%= parent.name %>)
                                </option>
                            <% }); %>
                        </select>
                    </div>
                </div>
                
                <!-- Persian Name -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="name_persian" class="form-label">ูุงู ูุงุฑุณ *</label>
                        <input type="text" name="name_persian" id="name_persian" 
                               class="form-control" required
                               placeholder="ูุซุงู: ุงูฺฏุดุชุฑุ ฺฏุฑุฏูุจูุฏุ ุณฺฉู ุชูุงู">
                        <small class="form-text text-muted">
                            ูุงู ููุงุด ุฏุณุชูโุจูุฏ ุจู ูุงุฑุณ
                        </small>
                    </div>
                </div>
                
                <!-- English Name -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="name" class="form-label">ูุงู ุงูฺฏูุณ *</label>
                        <input type="text" name="name" id="name" 
                               class="form-control" required
                               placeholder="rings, necklaces, full_coins"
                               pattern="[a-z_]+" 
                               title="ููุท ุญุฑูู ฺฉูฺฺฉ ุงูฺฏูุณ ู underscore">
                        <small class="form-text text-muted">
                            ูุงู ุชฺฉูฺฉ (ููุท ุญุฑูู ฺฉูฺฺฉ ุงูฺฏูุณ ู _)
                        </small>
                    </div>
                </div>
                
                <!-- Description -->
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="description" class="form-label">ุชูุถุญุงุช</label>
                        <textarea name="description" id="description" 
                                  class="form-control" rows="3"
                                  placeholder="ุชูุถุญ ูุฎุชุตุฑ ุฏุฑ ููุฑุฏ ุงู ุฏุณุชูโุจูุฏ..."></textarea>
                    </div>
                </div>
                
                <!-- Sort Order -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="sort_order" class="form-label">ุชุฑุชุจ ููุงุด</label>
                        <input type="number" name="sort_order" id="sort_order" 
                               class="form-control" value="0" min="0" max="999">
                        <small class="form-text text-muted">
                            ุนุฏุฏ ฺฉูุชุฑ = ููุงุด ุฏุฑ ุงุจุชุฏุง ูุณุช
                        </small>
                    </div>
                </div>
                
                <!-- Status -->
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">ูุถุนุช</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" 
                                   name="is_active" id="is_active" checked>
                            <label class="form-check-label" for="is_active">
                                ูุนุงู (ูุงุจู ุงุณุชูุงุฏู ุฏุฑ ุงูุฒูุฏู ฺฉุงูุง)
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div style="border-top: 1px solid #dee2e6; padding-top: 20px; margin-top: 20px;">
                <button type="submit" class="btn btn-success">
                    โ ุฐุฎุฑู ุฏุณุชูโุจูุฏ
                </button>
                <a href="/inventory/categories" class="btn btn-secondary">
                    ุงูุตุฑุงู
                </a>
            </div>
        </form>
    </div>
</div>

<!-- Help Section -->
<div class="card">
    <div class="card-header">
        ุฑุงูููุง
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h6>๐ ุฏุณุชูโุจูุฏ ุงุตู</h6>
                <ul>
                    <li>ฺฏุฑููโูุง ุงุตู ฺฉุงูุง (ูุซู ุฌูุงูุฑุงุชุ ุณฺฉูุ ุงฺฉุณุณูุฑ)</li>
                    <li>ูโุชูุงูุฏ ุดุงูู ุฒุฑูุฌููุนูโูุง ูุชุนุฏุฏ ุจุงุดุฏ</li>
                    <li>ูุงุจู ุญุฐู ุชููุง ุฏุฑ ุตูุฑุช ุนุฏู ูุฌูุฏ ุฒุฑูุฌููุนู ู ฺฉุงูุง</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h6>๐ ุฒุฑูุฌููุนู</h6>
                <ul>
                    <li>ุฏุณุชูโุจูุฏโูุง ุฌุฒุฆโุชุฑ (ูุซู ุงูฺฏุดุชุฑุ ุฏุณุชุจูุฏ)</li>
                    <li>ุจุงุฏ ุจู ฺฉ ุฏุณุชูโุจูุฏ ุงุตู ูุชุตู ุจุงุดุฏ</li>
                    <li>ฺฉุงูุงูุง ูุณุชููุงู ุจู ุฒุฑูุฌููุนูโูุง ุงุฎุชุตุงุต ูโุงุจูุฏ</li>
                </ul>
            </div>
        </div>
        
        <hr>
        
        <div class="alert alert-info">
            <strong>๐ก ูฺฉุชู:</strong> 
            ุจุนุฏ ุงุฒ ุงุฌุงุฏ ุฏุณุชูโุจูุฏโูุงุ ุฏุฑ ูุณูุช "ุงูุฒูุฏู ฺฉุงูุง ุฌุฏุฏ" ูโุชูุงูุฏ ฺฉุงูุงูุง ุฑุง ุจู ุงู ุฏุณุชูโุจูุฏโูุง ุงุฎุชุตุงุต ุฏูุฏ.
        </div>
    </div>
</div>

<script>
function toggleParentSelection() {
    const mainRadio = document.getElementById('main_category');
    const subRadio = document.getElementById('sub_category');
    const parentSelection = document.getElementById('parent_selection');
    const parentSelect = document.getElementById('parent_id');
    
    if (subRadio.checked) {
        parentSelection.style.display = 'block';
        parentSelect.required = true;
    } else {
        parentSelection.style.display = 'none';
        parentSelect.required = false;
        parentSelect.value = '';
    }
}

// Auto-generate English name from Persian
document.getElementById('name_persian').addEventListener('input', function() {
    const persianName = this.value;
    const englishInput = document.getElementById('name');
    
    if (!englishInput.value && persianName) {
        // Simple transliteration mapping
        const mapping = {
            'ุงูฺฏุดุชุฑ': 'rings',
            'ฺฏุฑุฏูุจูุฏ': 'necklaces', 
            'ุฏุณุชุจูุฏ': 'bracelets',
            'ฺฏูุดูุงุฑู': 'earrings',
            'ุณฺฉู': 'coins',
            'ุทูุง': 'gold',
            'ุฌูุงูุฑุงุช': 'jewelry',
            'ุงฺฉุณุณูุฑ': 'accessories',
            'ุณุงุนุช': 'watches',
            'ุฒูุฌุฑ': 'chains'
        };
        
        let suggestion = mapping[persianName] || persianName.replace(/\s+/g, '_').toLowerCase();
        englishInput.value = suggestion;
    }
});
</script> 