<div class="page-header">
    <h1 class="page-title">گزارشات مالی پیشرفته</h1>
    <p>صورت‌های مالی، سود و زیان، ترازنامه و تحلیل‌های مالی</p>
</div>

<!-- Report Selection -->
<div class="card">
    <div class="card-header">
        انتخاب گزارش
    </div>
    <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <button class="btn btn-primary btn-lg" onclick="showReport('profit-loss')" id="btn-profit-loss">
                <strong>📊 صورت سود و زیان</strong><br>
                <small>درآمدها و هزینه‌ها</small>
            </button>
            
            <button class="btn btn-outline-success btn-lg" onclick="showReport('balance-sheet')" id="btn-balance-sheet">
                <strong>🏦 ترازنامه</strong><br>
                <small>دارایی‌ها، بدهی‌ها و حقوق مالکانه</small>
            </button>
            
            <button class="btn btn-outline-info btn-lg" onclick="showReport('cash-flow')" id="btn-cash-flow">
                <strong>💰 صورت جریان وجه نقد</strong><br>
                <small>جریان‌های نقدی</small>
            </button>
            
            <button class="btn btn-outline-warning btn-lg" onclick="showReport('financial-analysis')" id="btn-financial-analysis">
                <strong>📈 تحلیل مالی</strong><br>
                <small>نسبت‌ها و اعداد کلیدی</small>
            </button>
        </div>
    </div>
</div>

<!-- Profit & Loss Statement -->
<div id="profit-loss-report" class="report-section">
    <div class="card">
        <div class="card-header">
            📊 صورت سود و زیان
            <span class="float-left">برای سال منتهی به 1403/09/30</span>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead style="background: #f8f9fa;">
                        <tr>
                            <th>شرح</th>
                            <th style="text-align: left; width: 200px;">مبلغ (ریال)</th>
                            <th style="text-align: center; width: 100px;">درصد</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Revenue Section -->
                        <tr style="background: #e8f5e8;">
                            <td colspan="3"><strong>درآمدها</strong></td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;&nbsp;&nbsp;فروش طلا</td>
                            <td style="text-align: left;">500,000,000</td>
                            <td style="text-align: center;">95%</td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;&nbsp;&nbsp;سایر درآمدها</td>
                            <td style="text-align: left;">25,000,000</td>
                            <td style="text-align: center;">5%</td>
                        </tr>
                        <tr style="font-weight: bold; background: #d4edda;">
                            <td><strong>مجموع درآمدها</strong></td>
                            <td style="text-align: left;"><strong>525,000,000</strong></td>
                            <td style="text-align: center;"><strong>100%</strong></td>
                        </tr>
                        
                        <!-- Net Income -->
                        <tr style="font-weight: bold; background: #28a745; color: white; font-size: 1.1em;">
                            <td><strong>سود خالص</strong></td>
                            <td style="text-align: left;"><strong>29,000,000</strong></td>
                            <td style="text-align: center;"><strong>6%</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Balance Sheet -->
<div id="balance-sheet-report" class="report-section" style="display: none;">
    <div class="card">
        <div class="card-header">
            🏦 ترازنامه
            <span class="float-left">در تاریخ 1403/09/30</span>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Assets -->
                <div>
                    <table class="table table-bordered">
                        <thead style="background: #d4edda;">
                            <tr>
                                <th colspan="2" class="text-center"><strong>دارایی‌ها</strong></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #e8f5e8;">
                                <td colspan="2"><strong>دارایی‌های جاری</strong></td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;صندوق</td>
                                <td style="text-align: left;">50,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;بانک</td>
                                <td style="text-align: left;">75,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;طلب مشتریان</td>
                                <td style="text-align: left;">30,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;موجودی کالا</td>
                                <td style="text-align: left;">120,000,000</td>
                            </tr>
                            <tr style="font-weight: bold; background: #d4edda;">
                                <td><strong>جمع دارایی‌های جاری</strong></td>
                                <td style="text-align: left;"><strong>275,000,000</strong></td>
                            </tr>
                            
                            <tr style="height: 10px;">
                                <td colspan="2"></td>
                            </tr>
                            
                            <tr style="background: #e8f5e8;">
                                <td colspan="2"><strong>دارایی‌های ثابت</strong></td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;تجهیزات</td>
                                <td style="text-align: left;">45,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;استهلاک انباشته</td>
                                <td style="text-align: left;">(15,000,000)</td>
                            </tr>
                            <tr style="font-weight: bold; background: #d4edda;">
                                <td><strong>جمع دارایی‌های ثابت</strong></td>
                                <td style="text-align: left;"><strong>30,000,000</strong></td>
                            </tr>
                            
                            <tr style="font-weight: bold; background: #28a745; color: white;">
                                <td><strong>مجموع دارایی‌ها</strong></td>
                                <td style="text-align: left;"><strong>305,000,000</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Liabilities & Equity -->
                <div>
                    <table class="table table-bordered">
                        <thead style="background: #f8d7da;">
                            <tr>
                                <th colspan="2" class="text-center"><strong>بدهی‌ها و حقوق مالکانه</strong></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #f8d7da;">
                                <td colspan="2"><strong>بدهی‌های جاری</strong></td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;حساب‌های پرداختنی</td>
                                <td style="text-align: left;">25,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;حقوق پرداختنی</td>
                                <td style="text-align: left;">8,000,000</td>
                            </tr>
                            <tr style="font-weight: bold; background: #f5c6cb;">
                                <td><strong>جمع بدهی‌های جاری</strong></td>
                                <td style="text-align: left;"><strong>33,000,000</strong></td>
                            </tr>
                            
                            <tr style="height: 10px;">
                                <td colspan="2"></td>
                            </tr>
                            
                            <tr style="background: #d1ecf1;">
                                <td colspan="2"><strong>حقوق مالکانه</strong></td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;سرمایه</td>
                                <td style="text-align: left;">200,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;سود انباشته</td>
                                <td style="text-align: left;">43,000,000</td>
                            </tr>
                            <tr>
                                <td>&nbsp;&nbsp;سود سال جاری</td>
                                <td style="text-align: left;">29,000,000</td>
                            </tr>
                            <tr style="font-weight: bold; background: #bee5eb;">
                                <td><strong>جمع حقوق مالکانه</strong></td>
                                <td style="text-align: left;"><strong>272,000,000</strong></td>
                            </tr>
                            
                            <tr style="font-weight: bold; background: #17a2b8; color: white;">
                                <td><strong>مجموع بدهی‌ها و حقوق</strong></td>
                                <td style="text-align: left;"><strong>305,000,000</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cash Flow Statement -->
<div id="cash-flow-report" class="report-section" style="display: none;">
    <div class="card">
        <div class="card-header">
            💰 صورت جریان وجه نقد
            <span class="float-left">برای سال منتهی به 1403/09/30</span>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead style="background: #f8f9fa;">
                        <tr>
                            <th>شرح</th>
                            <th style="text-align: left; width: 200px;">مبلغ (ریال)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #d4edda;">
                            <td colspan="2"><strong>جریان وجه نقد از فعالیت‌های عملیاتی</strong></td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;وجه نقد دریافتی از مشتریان</td>
                            <td style="text-align: left;">495,000,000</td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;وجه نقد پرداختی به تأمین‌کنندگان</td>
                            <td style="text-align: left;">(380,000,000)</td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;وجه نقد پرداختی بابت هزینه‌ها</td>
                            <td style="text-align: left;">(96,000,000)</td>
                        </tr>
                        <tr style="font-weight: bold; background: #c3e6cb;">
                            <td><strong>خالص وجه نقد حاصل از فعالیت‌های عملیاتی</strong></td>
                            <td style="text-align: left;"><strong>19,000,000</strong></td>
                        </tr>
                        
                        <tr style="height: 10px;">
                            <td colspan="2"></td>
                        </tr>
                        
                        <tr style="background: #d1ecf1;">
                            <td colspan="2"><strong>جریان وجه نقد از فعالیت‌های سرمایه‌گذاری</strong></td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;خرید تجهیزات</td>
                            <td style="text-align: left;">(15,000,000)</td>
                        </tr>
                        <tr style="font-weight: bold; background: #b8daff;">
                            <td><strong>خالص وجه نقد مصرف شده در فعالیت‌های سرمایه‌گذاری</strong></td>
                            <td style="text-align: left;"><strong>(15,000,000)</strong></td>
                        </tr>
                        
                        <tr style="height: 10px;">
                            <td colspan="2"></td>
                        </tr>
                        
                        <tr style="background: #fff3cd;">
                            <td colspan="2"><strong>جریان وجه نقد از فعالیت‌های تأمین مالی</strong></td>
                        </tr>
                        <tr>
                            <td>&nbsp;&nbsp;برداشت سرمایه</td>
                            <td style="text-align: left;">(10,000,000)</td>
                        </tr>
                        <tr style="font-weight: bold; background: #ffeaa7;">
                            <td><strong>خالص وجه نقد مصرف شده در فعالیت‌های تأمین مالی</strong></td>
                            <td style="text-align: left;"><strong>(10,000,000)</strong></td>
                        </tr>
                        
                        <tr style="height: 10px;">
                            <td colspan="2"></td>
                        </tr>
                        
                        <tr style="font-weight: bold; background: #007bff; color: white;">
                            <td><strong>خالص تغییر در وجه نقد</strong></td>
                            <td style="text-align: left;"><strong>(6,000,000)</strong></td>
                        </tr>
                        <tr>
                            <td>وجه نقد ابتدای سال</td>
                            <td style="text-align: left;">131,000,000</td>
                        </tr>
                        <tr style="font-weight: bold; background: #28a745; color: white;">
                            <td><strong>وجه نقد انتهای سال</strong></td>
                            <td style="text-align: left;"><strong>125,000,000</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Financial Analysis -->
<div id="financial-analysis-report" class="report-section" style="display: none;">
    <div class="card">
        <div class="card-header">
            📈 تحلیل مالی و نسبت‌های کلیدی
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <!-- Profitability Ratios -->
                <div style="background: #e8f5e8; padding: 20px; border-radius: 8px;">
                    <h6 style="color: #28a745; margin-bottom: 15px;">💰 نسبت‌های سودآوری</h6>
                    <table class="table table-sm">
                        <tr>
                            <td>حاشیه سود ناخالص:</td>
                            <td class="text-left"><strong>24%</strong></td>
                        </tr>
                        <tr>
                            <td>حاشیه سود خالص:</td>
                            <td class="text-left"><strong>6%</strong></td>
                        </tr>
                        <tr>
                            <td>بازده دارایی‌ها:</td>
                            <td class="text-left"><strong>9.5%</strong></td>
                        </tr>
                        <tr>
                            <td>بازده حقوق مالکانه:</td>
                            <td class="text-left"><strong>10.7%</strong></td>
                        </tr>
                    </table>
                </div>
                
                <!-- Liquidity Ratios -->
                <div style="background: #e3f2fd; padding: 20px; border-radius: 8px;">
                    <h6 style="color: #2196f3; margin-bottom: 15px;">💧 نسبت‌های نقدینگی</h6>
                    <table class="table table-sm">
                        <tr>
                            <td>نسبت جاری:</td>
                            <td class="text-left"><strong>8.3</strong></td>
                        </tr>
                        <tr>
                            <td>نسبت سریع:</td>
                            <td class="text-left"><strong>4.7</strong></td>
                        </tr>
                        <tr>
                            <td>نسبت نقدی:</td>
                            <td class="text-left"><strong>3.8</strong></td>
                        </tr>
                        <tr>
                            <td>وجه نقد به دارایی‌ها:</td>
                            <td class="text-left"><strong>41%</strong></td>
                        </tr>
                    </table>
                </div>
                
                <!-- Efficiency Ratios -->
                <div style="background: #fff3e0; padding: 20px; border-radius: 8px;">
                    <h6 style="color: #ff9800; margin-bottom: 15px;">⚡ نسبت‌های کارایی</h6>
                    <table class="table table-sm">
                        <tr>
                            <td>گردش دارایی‌ها:</td>
                            <td class="text-left"><strong>1.7 بار</strong></td>
                        </tr>
                        <tr>
                            <td>گردش موجودی:</td>
                            <td class="text-left"><strong>3.3 بار</strong></td>
                        </tr>
                        <tr>
                            <td>متوسط وصول مطالبات:</td>
                            <td class="text-left"><strong>21 روز</strong></td>
                        </tr>
                        <tr>
                            <td>چرخه نقدی:</td>
                            <td class="text-left"><strong>110 روز</strong></td>
                        </tr>
                    </table>
                </div>
                
                <!-- Leverage Ratios -->
                <div style="background: #fce4ec; padding: 20px; border-radius: 8px;">
                    <h6 style="color: #e91e63; margin-bottom: 15px;">📊 نسبت‌های اهرمی</h6>
                    <table class="table table-sm">
                        <tr>
                            <td>نسبت بدهی به دارایی:</td>
                            <td class="text-left"><strong>11%</strong></td>
                        </tr>
                        <tr>
                            <td>نسبت بدهی به حقوق:</td>
                            <td class="text-left"><strong>12%</strong></td>
                        </tr>
                        <tr>
                            <td>ضریب حقوق مالکانه:</td>
                            <td class="text-left"><strong>89%</strong></td>
                        </tr>
                        <tr>
                            <td>پوشش بهره:</td>
                            <td class="text-left"><strong>-</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <div class="card-header">
        عملیات
    </div>
    <div class="card-body">
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <a href="/accounting" class="btn btn-secondary">بازگشت به حسابداری</a>
            <a href="/accounting/trial-balance" class="btn btn-info">تراز آزمایشی</a>
            <a href="/accounting/journal-entries" class="btn btn-primary">دفتر روزنامه</a>
            <button onclick="window.print()" class="btn btn-outline-primary">چاپ</button>
        </div>
    </div>
</div>

<script>
function showReport(reportType) {
    // Hide all reports
    document.querySelectorAll('.report-section').forEach(section => {
        section.style.display = 'none';
    });
    
    // Reset all button styles
    document.querySelectorAll('button[id^="btn-"]').forEach(btn => {
        btn.className = btn.className.replace('btn-primary', 'btn-outline-primary')
                                   .replace('btn-success', 'btn-outline-success')
                                   .replace('btn-info', 'btn-outline-info')
                                   .replace('btn-warning', 'btn-outline-warning');
    });
    
    // Show selected report
    const reportElement = document.getElementById(reportType + '-report');
    if (reportElement) {
        reportElement.style.display = 'block';
    }
    
    // Highlight selected button
    const buttonElement = document.getElementById('btn-' + reportType);
    if (buttonElement) {
        if (reportType === 'profit-loss') {
            buttonElement.className = buttonElement.className.replace('btn-outline-primary', 'btn-primary');
        } else if (reportType === 'balance-sheet') {
            buttonElement.className = buttonElement.className.replace('btn-outline-success', 'btn-success');
        } else if (reportType === 'cash-flow') {
            buttonElement.className = buttonElement.className.replace('btn-outline-info', 'btn-info');
        } else if (reportType === 'financial-analysis') {
            buttonElement.className = buttonElement.className.replace('btn-outline-warning', 'btn-warning');
        }
    }
}

function exportToPDF() {
    alert('خروجی PDF - این قابلیت به زودی اضافه می‌شود');
}

// Show profit & loss by default
document.addEventListener('DOMContentLoaded', function() {
    showReport('profit-loss');
});
</script> 